<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AuD/PhD Connect</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f7fa;
        }

        header {
            background: linear-gradient(135deg, #EBA752 0%, #d44720 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            text-decoration: none;
            color: white;
        }

        nav {
            display: flex;
            gap: 2rem;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.05rem;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            transition: background 0.2s;
        }

        nav a:hover, nav a.active {
            background: rgba(255, 255, 255, 0.2);
        }

        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .page {
            display: none;
            min-height: calc(100vh - 200px);
        }

        .page.active {
            display: block;
        }

        /* Home Page Styles */
        .hero {
            text-align: center;
            padding: 4rem 1rem;
            background: linear-gradient(135deg, rgba(235, 167, 82, 0.1) 0%, rgba(212, 71, 32, 0.1) 100%);
            border-radius: 12px;
            margin: 2rem 0;
        }

        .hero h1 {
            font-size: 3rem;
            color: #d44720;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.3rem;
            color: #786140;
            max-width: 800px;
            margin: 0 auto 2rem;
        }

        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 2rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            transition: transform 0.2s, box-shadow 0.2s;
            display: inline-block;
        }

        .btn-primary {
            background: #EBA752;
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(235, 167, 82, 0.3);
        }

        .btn-secondary {
            background: white;
            color: #d44720;
            border: 2px solid #d44720;
        }

        .btn-secondary:hover {
            background: #d44720;
            color: white;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-top: 4px solid #EBA752;
        }

        .feature-card h3 {
            color: #d44720;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .feature-card p {
            color: #786140;
        }

        /* Directory Page Styles */
        .controls {
            background: white;
            padding: 1.5rem;
            margin: 2rem auto;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .search-bar {
            width: 100%;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            border: 2px solid #ACCAB2;
            border-radius: 6px;
            margin-bottom: 1rem;
            transition: border-color 0.3s;
        }

        .search-bar:focus {
            outline: none;
            border-color: #EBA752;
        }

        .filters {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #786140;
        }

        .filter-group select {
            width: 100%;
            padding: 0.5rem;
            border: 2px solid #ACCAB2;
            border-radius: 6px;
            font-size: 0.95rem;
            cursor: pointer;
        }

        .results-info {
            text-align: center;
            margin: 1rem 0;
            color: #786140;
            font-size: 0.95rem;
        }

        .directory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .person-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .person-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }

        .card-image {
            width: 100%;
            height: 280px;
            object-fit: cover;
            background: linear-gradient(135deg, #EBA752 0%, #d44720 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            font-weight: 700;
        }

        .card-content {
            padding: 1.5rem;
        }

        .card-name {
            font-size: 1.3rem;
            font-weight: 700;
            color: #d44720;
            margin-bottom: 0.5rem;
        }

        .card-position {
            font-size: 1rem;
            color: #786140;
            margin-bottom: 0.5rem;
        }

        .card-institution {
            font-size: 0.9rem;
            color: #ACCAB2;
        }

        .mentor-badge {
            display: inline-block;
            background: #ACCAB2;
            color: white;
            padding: 0.3rem 0.7rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 0.5rem;
        }

        .profile-view {
            display: none;
            max-width: 900px;
            margin: 2rem auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .back-button {
            display: inline-block;
            background: white;
            color: #d44720;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            text-decoration: none;
            margin-bottom: 1rem;
            font-weight: 600;
            transition: transform 0.2s;
            border: 2px solid #d44720;
        }

        .back-button:hover {
            transform: translateX(-4px);
            background: #d44720;
            color: white;
        }

        .profile-header {
            display: flex;
            gap: 2rem;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(235, 167, 82, 0.1) 0%, rgba(212, 71, 32, 0.1) 100%);
        }

        .profile-image {
            width: 200px;
            height: 200px;
            border-radius: 12px;
            object-fit: cover;
            background: linear-gradient(135deg, #EBA752 0%, #d44720 100%);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 4rem;
            font-weight: 700;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 2rem;
            font-weight: 700;
            color: #d44720;
            margin-bottom: 0.5rem;
        }

        .profile-position {
            font-size: 1.2rem;
            color: #786140;
            margin-bottom: 0.5rem;
        }

        .profile-institution {
            font-size: 1rem;
            color: #ACCAB2;
            margin-bottom: 1rem;
        }

        .profile-email {
            display: inline-block;
            background: #EBA752;
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            transition: background 0.2s;
        }

        .profile-email:hover {
            background: #d44720;
        }

        .profile-details {
            padding: 2rem;
        }

        .detail-section {
            margin-bottom: 1.5rem;
        }

        .detail-label {
            font-weight: 700;
            color: #d44720;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .detail-value {
            color: #786140;
            line-height: 1.8;
        }

        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .tag {
            background: #ACCAB2;
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* Events Page Styles */
        .page-header {
            text-align: center;
            padding: 2rem 0;
        }

        .page-header h2 {
            font-size: 2.5rem;
            color: #d44720;
            margin-bottom: 0.5rem;
        }

        .page-header p {
            font-size: 1.1rem;
            color: #786140;
        }

        .events-grid {
            display: grid;
            gap: 2rem;
            margin: 2rem 0;
        }

        .event-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 6px solid #EBA752;
        }

        .event-card h3 {
            color: #d44720;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .event-meta {
            display: flex;
            gap: 2rem;
            margin-bottom: 1rem;
            color: #786140;
            flex-wrap: wrap;
        }

        .event-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .event-description {
            color: #555;
            margin-bottom: 1rem;
        }

        .event-links {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .event-link {
            padding: 0.5rem 1rem;
            background: #ACCAB2;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            transition: background 0.2s;
        }

        .event-link:hover {
            background: #786140;
        }

        /* Resources Page Styles */
        .resources-content {
            max-width: 900px;
            margin: 2rem auto;
        }

        .resource-section {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .resource-section h3 {
            color: #d44720;
            font-size: 1.8rem;
            margin-bottom: 1rem;
            border-bottom: 3px solid #EBA752;
            padding-bottom: 0.5rem;
        }

        .resource-section h4 {
            color: #786140;
            font-size: 1.3rem;
            margin: 1.5rem 0 0.5rem;
        }

        .resource-section p {
            color: #555;
            line-height: 1.8;
            margin-bottom: 1rem;
        }

        .resource-section ul {
            margin-left: 2rem;
            color: #555;
        }

        .resource-section li {
            margin-bottom: 0.5rem;
        }

        .no-results, .loading {
            text-align: center;
            padding: 3rem;
            color: #786140;
            font-size: 1.1rem;
        }

        footer {
            background: #786140;
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 3rem;
        }

        @media (max-width: 768px) {
            nav {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: linear-gradient(135deg, #EBA752 0%, #d44720 100%);
                flex-direction: column;
                gap: 0;
                padding: 1rem;
            }

            nav.mobile-open {
                display: flex;
            }

            nav a {
                padding: 1rem;
                border-radius: 0;
            }

            .mobile-menu-toggle {
                display: block;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .directory-grid {
                grid-template-columns: 1fr;
            }

            .profile-header {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .profile-image {
                width: 150px;
                height: 150px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="#" class="logo" onclick="showPage('home'); return false;">AuD/PhD Connect</a>
            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">‚ò∞</button>
            <nav id="mainNav">
                <a href="#" onclick="showPage('home'); return false;" data-page="home" class="active">Home</a>
                <a href="#" onclick="showPage('directory'); return false;" data-page="directory">Directory</a>
                <a href="#" onclick="showPage('events'); return false;" data-page="events">Events</a>
                <a href="#" onclick="showPage('resources'); return false;" data-page="resources">Resources</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <!-- Home Page -->
        <div id="homePage" class="page active">
            <div class="hero">
                <h1>Welcome to AuD/PhD Connect</h1>
                <p>A community connecting audiologists pursuing or holding both AuD and PhD degrees. Connect, collaborate, and grow together.</p>
                <div class="cta-buttons">
                    <a href="#" onclick="showPage('directory'); return false;" class="btn btn-primary">Browse Directory</a>
                    <a href="#" onclick="showPage('events'); return false;" class="btn btn-secondary">View Events</a>
                </div>
            </div>

            <div class="features">
                <div class="feature-card">
                    <h3>Find Mentors</h3>
                    <p>Connect with experienced AuD/PhD professionals who are available to mentor and guide you through your academic journey.</p>
                </div>
                <div class="feature-card">
                    <h3>Network & Collaborate</h3>
                    <p>Discover colleagues with similar research interests and professional activities to collaborate on projects and share insights.</p>
                </div>
                <div class="feature-card">
                    <h3>Learn Pathways</h3>
                    <p>Explore different routes to obtaining both degrees, from simultaneous to sequential programs, and learn from others' experiences.</p>
                </div>
            </div>
        </div>

        <!-- Directory Page -->
        <div id="directoryPage" class="page">
            <div id="galleryView">
                <div class="page-header">
                    <h2>Member Directory</h2>
                    <p>Search and connect with AuD/PhD professionals</p>
                </div>

                <div class="controls">
                    <input 
                        type="text" 
                        id="searchInput" 
                        class="search-bar" 
                        placeholder="Search by name, institution, research areas, mentoring topics..."
                    >
                    
                    <div class="filters" id="filtersContainer"></div>
                </div>

                <div class="results-info" id="resultsInfo"></div>
                
                <div id="loading" class="loading">Loading directory...</div>
                <div class="directory-grid" id="directoryGrid"></div>
            </div>

            <div id="profileView" class="profile-view">
                <a href="#" class="back-button" onclick="showGallery(); return false;">‚Üê Back to Directory</a>
                <div id="profileContent"></div>
            </div>
        </div>

        <!-- Events Page -->
        <div id="eventsPage" class="page">
            <div class="page-header">
                <h2>Upcoming Events</h2>
                <p>Join us for meetups, webinars, and networking opportunities</p>
            </div>

            <div class="events-grid" id="eventsGrid">
                <!-- Events will be loaded here -->
                <div class="event-card">
                    <h3>Monthly Virtual Meetup</h3>
                    <div class="event-meta">
                        <span class="event-meta-item">üìÖ First Thursday of each month</span>
                        <span class="event-meta-item">‚è∞ 7:00 PM EST</span>
                    </div>
                    <p class="event-description">Join fellow AuD/PhD professionals for informal networking and discussion. Share your research, ask questions, and build connections.</p>
                    <div class="event-links">
                        <a href="#" class="event-link">Join Zoom Meeting</a>
                        <a href="#" class="event-link">Add to Calendar</a>
                    </div>
                </div>

                <div class="event-card">
                    <h3>Research Presentation Series</h3>
                    <div class="event-meta">
                        <span class="event-meta-item">üìÖ Quarterly</span>
                        <span class="event-meta-item">‚è∞ TBA</span>
                    </div>
                    <p class="event-description">Members present their current research projects and receive feedback from the community. A great opportunity to practice presentations and get constructive input.</p>
                    <div class="event-links">
                        <a href="#" class="event-link">View Schedule</a>
                        <a href="#" class="event-link">Submit to Present</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resources Page -->
        <div id="resourcesPage" class="page">
            <div class="page-header">
                <h2>Resources</h2>
                <p>Information and guidance for pursuing AuD and PhD degrees</p>
            </div>

            <div class="resources-content">
                <div class="resource-section">
                    <h3>AuD/PhD Pathways</h3>
                    <p>There are several routes to obtaining both an AuD (Doctor of Audiology) and PhD degree. Understanding these pathways can help you make informed decisions about your educational journey.</p>
                    
                    <h4>Simultaneous Programs</h4>
                    <p>Some institutions offer joint AuD/PhD programs where students pursue both degrees concurrently. This pathway typically takes 5-7 years to complete and allows for integration of clinical training with research methodology.</p>
                    <ul>
                        <li>Efficient use of time by completing both degrees together</li>
                        <li>Coordinated curriculum that bridges clinical and research training</li>
                        <li>Often includes funding support throughout the program</li>
                        <li>Requires careful time management and dedication</li>
                    </ul>

                    <h4>Sequential Programs</h4>
                    <p>Many professionals complete one degree before pursuing the other. This can be done in either order: AuD first, then PhD, or PhD first, then AuD.</p>
                    <ul>
                        <li><strong>AuD then PhD:</strong> Gain clinical experience before focusing on research</li>
                        <li><strong>PhD then AuD:</strong> Develop research expertise before clinical training</li>
                        <li>Allows for work experience between degrees</li>
                        <li>May take longer overall but offers flexibility in career development</li>
                    </ul>

                    <h4>Same vs. Different Institutions</h4>
                    <p>Students may complete both degrees at the same institution or attend different schools for each degree. Each approach has distinct advantages:</p>
                    <ul>
                        <li><strong>Same Institution:</strong> Established relationships with faculty, familiarity with resources, potential for streamlined processes</li>
                        <li><strong>Different Institutions:</strong> Exposure to diverse perspectives, broader professional network, varied research experiences</li>
                    </ul>
                </div>

                <div class="resource-section">
                    <h3>Funding Opportunities</h3>
                    <p>Various funding mechanisms support students pursuing AuD and PhD degrees:</p>
                    <ul>
                        <li><strong>NIH F31:</strong> Predoctoral fellowship for PhD students conducting health-related research</li>
                        <li><strong>NIH F32:</strong> Postdoctoral fellowship for recent PhD graduates</li>
                        <li><strong>NSF GRFP:</strong> Graduate Research Fellowship Program supporting STEM graduate students</li>
                        <li><strong>HHF ERG:</strong> Hearing Health Foundation Emerging Research Grants</li>
                        <li><strong>Institutional Funding:</strong> Teaching assistantships, research assistantships, and departmental scholarships</li>
                    </ul>
                </div>

                <div class="resource-section">
                    <h3>Example Pathways</h3>
                    
                    <h4>Example 1: Simultaneous Program</h4>
                    <p>"I entered a joint AuD/PhD program directly after completing my undergraduate degree. Over 6 years, I completed clinical rotations while also conducting dissertation research. The integrated curriculum allowed me to apply research principles to clinical questions immediately."</p>
                    
                    <h4>Example 2: Sequential (AuD First)</h4>
                    <p>"After earning my AuD and working as a clinical audiologist for 3 years, I returned to pursue a PhD. My clinical experience helped me identify research questions that mattered to practitioners and patients. I completed my PhD in 4 years while maintaining some clinical work."</p>
                    
                    <h4>Example 3: Sequential (PhD First)</h4>
                    <p>"I completed my PhD in hearing science first, then decided clinical training would enhance my research program. I pursued an AuD as a post-PhD professional. This gave me a strong research foundation before developing clinical skills."</p>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2026 AuD/PhD Connect. Built with ‚ù§Ô∏è for the audiology community.</p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script>
        let allPeople = [];
        let filteredPeople = [];
        
        const multiSelectFields = [
            'Current Professional Activities',
            'Research Topic Area(s)',
            'What professional topics would you be interested in providing mentoring on?',
            'What level mentee do you typically work with?',
            'What funding mechanisms do you have experience with? (e.g., NIH F32, NSF GRFP, HHF ERG'
        ];

        const cardFields = {
            name: 'Name (as it should be listed in the directory, i.e., First Last, credentials)',
            photo: 'Profile Picture',
            position: 'Current Position',
            institution: 'Current Affiliation (e.g., university, company name)',
            mentor: 'Do you agree to mentor individuals who reach out to you?'
        };

        const filterableFields = [
            'Research Category',
            'Research Topic Area(s)',
            'Do you agree to mentor individuals who reach out to you?',
            'What professional topics would you be interested in providing mentoring on?',
            'What level mentee do you typically work with?',
            'Did you obtain your AuD and PhD from the same institution?',
            'Did you complete your AuD and PhD simultaneously or sequentially?'
        ];

        const skipInDetailView = [
            'Timestamp',
            'Name (as it should be listed in the directory, i.e., First Last, credentials)',
            'Profile Picture',
            'Current Position',
            'Current Affiliation (e.g., university, company name)',
            'Email (this will be what is used for connecting with you)'
        ];

        function showPage(pageName) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.querySelectorAll('nav a').forEach(link => link.classList.remove('active'));
            
            document.getElementById(pageName + 'Page').classList.add('active');
            document.querySelector(`nav a[data-page="${pageName}"]`).classList.add('active');
            
            if (pageName === 'directory') {
                showGallery();
            }
            
            window.scrollTo(0, 0);
            
            const nav = document.getElementById('mainNav');
            nav.classList.remove('mobile-open');
        }

        function toggleMobileMenu() {
            const nav = document.getElementById('mainNav');
            nav.classList.toggle('mobile-open');
        }

        async function loadData() {
            try {
                const response = await fetch('data.csv');
                const csvText = await response.text();
                
                Papa.parse(csvText, {
                    header: true,
                    skipEmptyLines: true,
                    complete: function(results) {
                        allPeople = results.data.map(person => {
                            const processed = {...person};
                            
                            multiSelectFields.forEach(field => {
                                if (processed[field]) {
                                    processed[field] = processed[field]
                                        .split(/[,;]/)
                                        .map(item => item.trim())
                                        .filter(item => item && item !== 'NA');
                                }
                            });
                            
                            return processed;
                        });
                        
                        filteredPeople = allPeople;
                        initializeFilters();
                        renderDirectory();
                        document.getElementById('loading').style.display = 'none';
                    },
                    error: function(error) {
                        console.error('Error parsing CSV:', error);
                        document.getElementById('loading').innerHTML = 
                            'Error loading data. Please make sure data.csv is in the same directory.';
                    }
                });
            } catch (error) {
                console.error('Error loading CSV:', error);
                document.getElementById('loading').innerHTML = 
                    'Error loading data. Please make sure data.csv is in the same directory.';
            }
        }

        function initializeFilters() {
            const filtersContainer = document.getElementById('filtersContainer');

            filterableFields.forEach(field => {
                let uniqueValues = new Set();
                
                allPeople.forEach(person => {
                    if (Array.isArray(person[field])) {
                        person[field].forEach(v => v && uniqueValues.add(v));
                    } else if (person[field] && person[field] !== 'NA') {
                        uniqueValues.add(person[field]);
                    }
                });
                
                uniqueValues = Array.from(uniqueValues).filter(v => v);
                
                if (uniqueValues.length > 0) {
                    const filterGroup = document.createElement('div');
                    filterGroup.className = 'filter-group';
                    
                    const label = document.createElement('label');
                    const shortLabels = {
                        'Research Category': 'Research Category',
                        'Research Topic Area(s)': 'Research Topics',
                        'Do you agree to mentor individuals who reach out to you?': 'Available to Mentor',
                        'What professional topics would you be interested in providing mentoring on?': 'Mentoring Topics',
                        'What level mentee do you typically work with?': 'Mentee Level',
                        'Did you obtain your AuD and PhD from the same institution?': 'Same Institution',
                        'Did you complete your AuD and PhD simultaneously or sequentially?': 'Degree Timing'
                    };
                    label.textContent = shortLabels[field] || field;
                    
                    const select = document.createElement('select');
                    select.id = `filter-${field}`;
                    select.innerHTML = `<option value="">All</option>`;
                    
                    uniqueValues.sort().forEach(value => {
                        const option = document.createElement('option');
                        option.value = value;
                        option.textContent = value;
                        select.appendChild(option);
                    });
                    
                    select.addEventListener('change', applyFilters);
                    
                    filterGroup.appendChild(label);
                    filterGroup.appendChild(select);
                    filtersContainer.appendChild(filterGroup);
                }
            });
        }

        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filterSelects = document.querySelectorAll('.filter-group select');
            
            filteredPeople = allPeople.filter(person => {
                const searchMatch = Object.entries(person).some(([key, value]) => {
                    if (Array.isArray(value)) {
                        return value.some(v => v.toLowerCase().includes(searchTerm));
                    }
                    return value && value.toString().toLowerCase().includes(searchTerm);
                });
                
                if (!searchMatch) return false;
                
                for (let select of filterSelects) {
                    const field = select.id.replace('filter-', '');
                    const filterValue = select.value;
                    
                    if (filterValue) {
                        if (Array.isArray(person[field])) {
                            if (!person[field].includes(filterValue)) return false;
                        } else if (person[field] !== filterValue) {
                            return false;
                        }
                    }
                }
                
                return true;
            });
            
            renderDirectory();
        }

        function getInitials(name) {
            return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
        }

        function renderDirectory() {
            const grid = document.getElementById('directoryGrid');
            const resultsInfo = document.getElementById('resultsInfo');
            
            resultsInfo.textContent = `Showing ${filteredPeople.length} of ${allPeople.length} people`;
            
            if (filteredPeople.length === 0) {
                grid.innerHTML = '<div class="no-results">No results found. Try adjusting your search or filters.</div>';
                return;
            }
            
            grid.innerHTML = filteredPeople.map((person, index) => {
                const photoUrl = person[cardFields.photo] || '';
                const name = person[cardFields.name] || 'Unknown';
                const position = person[cardFields.position] || '';
                const institution = person[cardFields.institution] || '';
                const isMentor = person[cardFields.mentor] && person[cardFields.mentor].toLowerCase().includes('yes');
                
                const initials = getInitials(name);
                
                const imageHtml = photoUrl ? 
                    `<img src="${photoUrl}" alt="${name}" class="card-image" onerror="this.outerHTML='<div class=\\'card-image\\'>${initials}</div>';">` :
                    `<div class="card-image">${initials}</div>`;
                
                return `
                    <div class="person-card" onclick="showProfile(${allPeople.indexOf(person)})">
                        ${imageHtml}
                        <div class="card-content">
                            <div class="card-name">${name}</div>
                            <div class="card-position">${position}</div>
                            <div class="card-institution">${institution}</div>
                            ${isMentor ? '<span class="mentor-badge">Available to Mentor</span>' : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function showProfile(personIndex) {
            const person = allPeople[personIndex];
            const photoUrl = person[cardFields.photo] || '';
            const name = person[cardFields.name] || 'Unknown';
            const position = person[cardFields.position] || '';
            const institution = person[cardFields.institution] || '';
            const email = person['Email (this will be what is used for connecting with you)'] || '';
            
            const initials = getInitials(name);
            
            const imageHtml = photoUrl ? 
                `<img src="${photoUrl}" alt="${name}" class="profile-image" onerror="this.outerHTML='<div class=\\'profile-image\\'>${initials}</div>';">` :
                `<div class="profile-image">${initials}</div>`;
            
            const detailSections = Object.entries(person)
                .filter(([key]) => !skipInDetailView.includes(key) && person[key] && person[key] !== 'NA')
                .map(([key, value]) => {
                    let displayValue;
                    
                    if (Array.isArray(value) && value.length > 0) {
                        displayValue = `
                            <div class="tag-list">
                                ${value.map(v => `<span class="tag">${v}</span>`).join('')}
                            </div>
                        `;
                    } else if (value) {
                        displayValue = `<div class="detail-value">${value}</div>`;
                    } else {
                        return '';
                    }
                    
                    return `
                        <div class="detail-section">
                            <div class="detail-label">${key}</div>
                            ${displayValue}
                        </div>
                    `;
                }).filter(s => s).join('');
            
            document.getElementById('profileContent').innerHTML = `
                <div class="profile-header">
                    ${imageHtml}
                    <div class="profile-info">
                        <div class="profile-name">${name}</div>
                        <div class="profile-position">${position}</div>
                        <div class="profile-institution">${institution}</div>
                        ${email ? `<a href="mailto:${email}" class="profile-email">Contact via Email</a>` : ''}
                    </div>
                </div>
                <div class="profile-details">
                    ${detailSections}
                </div>
            `;
            
            document.getElementById('galleryView').style.display = 'none';
            document.getElementById('profileView').style.display = 'block';
            window.scrollTo(0, 0);
        }

        function showGallery() {
            document.getElementById('galleryView').style.display = 'block';
            document.getElementById('profileView').style.display = 'none';
            window.scrollTo(0, 0);
        }

        document.getElementById('searchInput').addEventListener('input', applyFilters);
        loadData();
    </script>
</body>
</html>
